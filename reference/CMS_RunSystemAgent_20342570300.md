<div id="page">

<div id="main" class="aui-page-panel">

<div id="main-header">

<div id="breadcrumb-section">

1.  [CapaInstaller 6.7 Documentation Public](index.html)
2.  [CMS Functions](CMS-Functions_20342569060.html)

</div>

# <span id="title-text"> CapaInstaller 6.7 Documentation Public : CMS_RunSystemAgent </span>

</div>

<div id="content" class="view">

<div class="page-metadata">

Created by <span class="author"> Henrik Wendt</span>, last modified by <span class="editor"> Simon Toftedal Hansen - STH</span> on Feb 25, 2025

</div>

<div id="main-content" class="wiki-content group">

#### Description

Reruns the CapaInstaller Service Agent. From a VBScript package, a registry key is created to instruct the CiStub service to start a ‘Remote run’. In the PowerShell implementation a ‘CallHome’ Unitcommand is created in the SQL database.

### Syntax

:vb: CMS_RunSystemAgent() As Boolean

:ps: \[bool\]CMS_RunSystemAgent -delay \<string\>

### Parameters

delay (string)

The delay after which the CallHome unitCommand will be executed.

The format used for delay is very simple. Here are some examples:

‘2m’ is two minutes.

‘1h’ is one hour

‘4h35m11s’ is four hours, thirty-five minutes and eleven seconds

‘2m30s’ is two minutes and thirty seconds

‘0s’ or '' (an empty string) equals no delay and means that the command will be executed right after the current agent run.

### Return value

:vb: Boolean, TRUE if function completed successfully.

:ps: Boolean, TRUE if function completed successfully.

### Example

##### :vb: **VBScript**

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
If bStatus Then bStatus = CMS_RunSystemAgent()
```

</div>

</div>

##### :ps: **PowerShell**

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
# run the system agent in 2 minutes
CMS_RunSystemAgent -delay '2m'

# run the system agent in one and a half hour
CMS_RunSystemAgent '1h30m'

# run the system agent after the current run has finished
CMS_RunSystemAgent -delay '0s'
```

</div>

</div>

<a href="https://capasystems.atlassian.net/wiki/spaces/CI67DOC/pages/20342575822/Scripting+Guidelines" data-linked-resource-id="20342575822" data-linked-resource-version="1" data-linked-resource-type="page">Scripting Guidelines</a>

### Related functions

<a href="https://capasystems.atlassian.net/wiki/spaces/CI67DOC/pages/20342570336" data-card-appearance="inline" rel="nofollow">https://capasystems.atlassian.net/wiki/spaces/CI67DOC/pages/20342570336</a>  
<a href="https://capasystems.atlassian.net/wiki/spaces/CI67DOC/pages/20342570249" data-card-appearance="inline" rel="nofollow">https://capasystems.atlassian.net/wiki/spaces/CI67DOC/pages/20342570249</a>

</div>

</div>

</div>

<div id="footer" role="contentinfo">

<div class="section footer-body">

Document generated by Confluence on Oct 15, 2025 11:43

<div id="footer-logo">

[Atlassian](http://www.atlassian.com/)

</div>

</div>

</div>

</div>
