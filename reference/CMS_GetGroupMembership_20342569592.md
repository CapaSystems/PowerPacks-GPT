<div id="page">

<div id="main" class="aui-page-panel">

<div id="main-header">

<div id="breadcrumb-section">

1.  [CapaInstaller 6.7 Documentation Public](index.html)
2.  [CMS Functions](CMS-Functions_20342569060.html)

</div>

# <span id="title-text"> CapaInstaller 6.7 Documentation Public : CMS_GetGroupMembership </span>

</div>

<div id="content" class="view">

<div class="page-metadata">

Created by <span class="author"> Henrik Wendt</span>, last modified by <span class="editor"> Simon Toftedal Hansen - STH</span> on Feb 25, 2025

</div>

<div id="main-content" class="wiki-content group">

### Description

The function returns which groups the current Unit is a member of

For Business Unit support click <a href="https://capasystems.atlassian.net/wiki/spaces/CI67DOC/pages/20342578502/Business+Unit+support" data-linked-resource-id="20342578502" data-linked-resource-version="1" data-linked-resource-type="page">here</a>

### Syntax

:vb: CMS_GetGroupMembership() As Boolean

:ps: \[CiGroup\[\]\]CMS_GetGroupMembership

### Return value

:vb: Result will be stored in gaValue

:ps: The function will return an array of the type CiGroup:

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
class CiGroup {
  [string]$Unittype
  [int]$Id
  [string]$Name
  [string]$Description
  [string]$Type
  [string]$Typedisplayname
  [string]$Icon
  [int]$Cmpid
  [string]$Scheduleid
  [bool]$Groupdeleted
  [string]$Businessunitid
  [int]$Linkedprofilecount
  [int]$Linkedapplicationcount
  [int]$Linkedpackagecount
  [int]$Linkedunitcount
  [int]$Folderid
  [string]$Guid
  [string]$Objecttype
  [int]$Parentid
  [int]$Packagetype
  [int]$Reinstallid
  [string]$Mode
  [DateTime]$Lastexecuted
  [int]$Pointid
  [int]$Osimageid
  [int]$Diskconfigid
  [int]$Installtypeid
  [int]$Osserverid
  [bool]$Clearallpackages
  [bool]$Clearallpackagesandgroups
  [object]$Customfield1
  [object]$Customfield2
}
```

</div>

</div>

### Example

##### :vb: **VBScript**

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
If bStatus Then bStatus = CMS_GetGroupMembership()      
For index = LBound(gaValue) to UBound(gaValue)   
  xStatus = Job_WriteLog("Custom", "Index #" & index & ": '" & cStr(gaValue(index)) & "'", bStatus, True)   
Next
```

</div>

</div>

##### :ps: **PowerShell**

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
CMS_GetGroupMembership | ForEach-Object {
  $cs.Job_WriteLog("Group Name: ", $_.Name)
  $cs.Job_WriteLog("Description: ", $_.Description)
  $cs.Job_WriteLog("Type: ", $_.Type)
  $cs.Job_WriteLog("TypeDisplayName: ", $_.Typedisplayname)
  $cs.Job_WriteLog("Id: ", $_.Id)
  $cs.Job_WriteLog("Guid: ", $_.Guid)
  $cs.Job_WriteLog("CmpID: ", $_.Cmpid)
  $cs.Job_WriteLog("------","------")
} 
  
# Expected output:
2023-11-19 20:38:25 - Group Name:  calendar1
2023-11-19 20:38:25 - Description:  First Calendar
2023-11-19 20:38:25 - Type:  1
2023-11-19 20:38:25 - TypeDisplayName:  Calendar
2023-11-19 20:38:25 - Id:  5027
2023-11-19 20:38:25 - Guid:  20e9a444-62c1-464e-bf6f-5994fd47f37a
2023-11-19 20:38:25 - CmpID:  1
2023-11-19 20:38:25 - ------ ------
2023-11-19 20:38:25 - Group Name:  Static One
2023-11-19 20:38:25 - Description:  First Static test group
2023-11-19 20:38:25 - Type:  7
2023-11-19 20:38:25 - TypeDisplayName:  Static
2023-11-19 20:38:25 - Id:  5025
2023-11-19 20:38:25 - Guid:  6b11640d-8303-4b92-8090-e646d025f9cf
2023-11-19 20:38:25 - CmpID:  1
2023-11-19 20:38:25 - ------ ------
  
```

</div>

</div>

<a href="https://capasystems.atlassian.net/wiki/spaces/CI67DOC/pages/20342575822/Scripting+Guidelines" data-linked-resource-id="20342575822" data-linked-resource-version="1" data-linked-resource-type="page">Scripting Guidelines</a>

</div>

</div>

</div>

<div id="footer" role="contentinfo">

<div class="section footer-body">

Document generated by Confluence on Oct 15, 2025 11:43

<div id="footer-logo">

[Atlassian](http://www.atlassian.com/)

</div>

</div>

</div>

</div>
