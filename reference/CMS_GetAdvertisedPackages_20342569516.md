<div id="page">

<div id="main" class="aui-page-panel">

<div id="main-header">

<div id="breadcrumb-section">

1.  [CapaInstaller 6.7 Documentation Public](index.html)
2.  [CMS Functions](CMS-Functions_20342569060.html)

</div>

# <span id="title-text"> CapaInstaller 6.7 Documentation Public : CMS_GetAdvertisedPackages </span>

</div>

<div id="content" class="view">

<div class="page-metadata">

Created by <span class="author"> Henrik Wendt</span>, last modified by <span class="editor"> Simon Toftedal Hansen - STH</span> on Feb 25, 2025

</div>

<div id="main-content" class="wiki-content group">

### Description

Returns all packages advertised to the unit

### Syntax

:vb: CMS_GetAdvertisedPackages() As Boolean

:ps: \[CiAdvertisedPackage\[\]\]CMS_GetAdvertisedPackages

### Return value

:vb: Result will be stored in gaValue

:ps: The function will return an array of the type CiAdvertisedPackage;

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
class CiAdvertisedPackage {
  [int]$Jobid
  [int]$Type
  [string]$Name
  [string]$Version
  [bool]$Uninstallscript
  [string]$Catalogname
  [string]$Description
  [int]$Advertiseddate
  [string]$Groupname
  [bool]$Autoexpand
}
```

</div>

</div>

### Example

##### :vb: **VBScript**

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
If bStatus Then bStatus = CMS_GetAdvertisedPackages()       
If bStatus Then
  For index = LBound(gaValue) to UBound(gaValue)    
    xStatus = Job_WriteLog("Custom", "Index #" & index & ": '" & cStr(gaValue(index)) & "'", bStatus, True)    
  Next 
End If
```

</div>

</div>

##### :ps: **PowerShell**

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
foreach ($advpck in CMS_GetAdvertisedPackages) {
    $cs.Job_WriteLog("Package Name:", $advpck.Name)
    $cs.Job_WriteLog("Package Version:", $advpck.Version)
    $cs.Job_WriteLog("Catalog name:", $advpck.Catalogname)
    $cs.Job_WriteLog("JobId:", $advpck.Jobid)
    $cs.Job_WriteLog("----", "----")
}

# Expected output:
2023-11-19 20:14:04 - Package Name: The Brand New PowerPack 4.5 de
2023-11-19 20:14:04 - Package Version: v1.0
2023-11-19 20:14:04 - Catalog name: The Brand New PowerPack 4.5 de v1.0
2023-11-19 20:14:04 - JobId: 130
2023-11-19 20:14:04 - ---- ----
2023-11-19 20:14:04 - Package Name: The Pack Mule 3.0 eng
2023-11-19 20:14:04 - Package Version: v1.0
2023-11-19 20:14:04 - Catalog name: The Pack Mule 3.0 eng v1.0
2023-11-19 20:14:04 - JobId: 125
2023-11-19 20:14:04 - ---- ----
2023-11-19 20:14:04 - Package Name: The Six Pack 2.0
2023-11-19 20:14:04 - Package Version: v1.0
2023-11-19 20:14:04 - Catalog name: The Six Pack 2.0 v1.0
2023-11-19 20:14:04 - JobId: 127
2023-11-19 20:14:04 - ---- ----
2023-11-19 20:14:04 - Package Name: Welcome to the Packateria 3.33 it
2023-11-19 20:14:04 - Package Version: v1.0
2023-11-19 20:14:04 - Catalog name: Welcome to the Packateria 3.33 it v1.0
2023-11-19 20:14:04 - JobId: 161
2023-11-19 20:14:04 - ---- ----
```

</div>

</div>

<a href="https://capasystems.atlassian.net/wiki/spaces/CI67DOC/pages/20342575822/Scripting+Guidelines" data-linked-resource-id="20342575822" data-linked-resource-version="1" data-linked-resource-type="page">Scripting Guidelines</a>

</div>

</div>

</div>

<div id="footer" role="contentinfo">

<div class="section footer-body">

Document generated by Confluence on Oct 15, 2025 11:43

<div id="footer-logo">

[Atlassian](http://www.atlassian.com/)

</div>

</div>

</div>

</div>
