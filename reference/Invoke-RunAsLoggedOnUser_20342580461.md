<div id="page">

<div id="main" class="aui-page-panel">

<div id="main-header">

<div id="breadcrumb-section">

1.  [CapaInstaller 6.7 Documentation Public](index.html)
2.  [PowerShell Scripting Library](PowerShell-Scripting-Library_20342578761.html)

</div>

# <span id="title-text"> CapaInstaller 6.7 Documentation Public : Invoke-RunAsLoggedOnUser </span>

</div>

<div id="content" class="view">

<div class="page-metadata">

Created by <span class="author"> Henrik Wendt</span>, last modified by <span class="editor"> Mark Bønnelykke Rasmussen</span> on Mar 27, 2025

</div>

<div id="main-content" class="wiki-content group">

Run a single command through the Task Scheduler as an random signed on user or the one specified.

<div class="confluence-information-macro confluence-information-macro-note">

<span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span>

<div class="confluence-information-macro-body">

If no user or the user that is specified i not logged on currently, then nothing will happen

</div>

</div>

### Syntax

Invoke-RunAsLoggedOnUser -command \<string\> -username \<string\> -arguments \<string\>

### Parameters

command

command to execute. Example “C:\Program Files\PowerShell\7\pwsh.exe”

username

username of the user it should run as, if not specified will it find a logged on user. The user must be logged on physically else nothing will happen. Default is \$null

arguments

argumtents for the command. Default is \$null

### Example

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
Invoke-RunAsLoggedOnUser -command 'mkdir' -arguments 'C:\Temp'
```

</div>

</div>

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
Invoke-RunAsLoggedOnUser -command 'mkdir' -arguments 'C:\Users\test\Documents' -username 'domain\username'
```

</div>

</div>

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
$Command = “C:\Program Files\PowerShell\7\pwsh.exe”
$Arguments = "-Command `"Import-PfxCertificate -Password `$('$PlainTextPassword' | ConvertTo-SecureString -AsPlainText -Force) 'C:\Cert.p12' -CertStoreLocation Cert:\currentUser\My`""

Invoke-RunAsLoggedOnUser -command $Command -arguments $Arguments
```

</div>

</div>

</div>

</div>

</div>

<div id="footer" role="contentinfo">

<div class="section footer-body">

Document generated by Confluence on Oct 15, 2025 09:10

<div id="footer-logo">

[Atlassian](http://www.atlassian.com/)

</div>

</div>

</div>

</div>
