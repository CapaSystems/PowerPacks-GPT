<div id="page">

<div id="main" class="aui-page-panel">

<div id="main-header">

<div id="breadcrumb-section">

1.  [CapaInstaller 6.7 Documentation Public](index.html)
2.  [CMS Functions](CMS-Functions_20342569060.html)

</div>

# <span id="title-text"> CapaInstaller 6.7 Documentation Public : CMS_SetPackageStatusToNotCompliant </span>

</div>

<div id="content" class="view">

<div class="page-metadata">

Created by <span class="author"> Henrik Wendt</span>, last modified by <span class="editor"> Mark Bønnelykke Rasmussen</span> on Sep 29, 2025

</div>

<div id="main-content" class="wiki-content group">

### Description

Implemented in CapaInstaller 5.0 Build 103

Will set the status of the running package to 'Not Compliant'.  
This function is intended to be used before the package has been downloaded and/or before the user has been prompted to allow installation of the package. 

### Syntax

:vb: CMS_SetPackageStatusToNotCompliant(sPackage, sVersion) As Boolean

:ps: \$cs.CMS_SetPackageStatusToNotCompliant()

### Parameters

*sPackage (String)*

Package name

*sVersion (String)*

Package version

### Return value

:vb: Boolean, TRUE if function completed successfully.

:ps: Boolean, TRUE if function completed successfully.

### Example

The example below shows how this function could be used in a real world situation. The CompliancyCheck function could be included in the package itself or provided via CustomLib.cis and will prevent a package from running on 64 bit OS in this case.

##### :vb: **VBScript**

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
' this function will set bStatus to FALSE in order to skip the Job execution.'
Function CompliancyCheck()
  Dim bStatus : bStatus = True
  If gbx64 Then
    If bStatus Then bStatus = Job_WriteLog("CompliancyCheck", "Package is not allowed to run on 64 bit OS", bStatus, True)
    If bStatus Then bStatus = CMS_SetPackageStatusToNotCompliant("CapaInstaller", "v1.0")
  End If
  CompliancyCheck = bStatus
End Function
```

</div>

</div>

##### :ps: PowerShell

<div class="code panel pdl" style="border-width: 1px;">

<div class="codeContent panelContent pdl">

``` syntaxhighlighter-pre
# this function will set the package status to NotCompliant
function CompliancyCheck() {
  $result = true
  if ($env:PROCESSOR_ARCHITECTURE -eq "AMD64") {
    $cs.Job_WriteLog("CompliancyCheck", "Package is not allowed to run on 64 bit OS")    
    $cs.CMS_SetPackageStatusToNotCompliant()
    return $false
  }
  return $result
}
```

</div>

</div>

<a href="https://capasystems.atlassian.net/wiki/spaces/CI67DOC/pages/20342575822/Scripting+Guidelines" data-linked-resource-id="20342575822" data-linked-resource-version="1" data-linked-resource-type="page">Scripting Guidelines</a>

### Related functions

<a href="CMS_SetPackageStatusToInstalled_20342570418.html" data-linked-resource-id="20342570418" data-linked-resource-version="2" data-linked-resource-type="page">CMS_SetPackageStatusToInstalled</a>

</div>

</div>

</div>

<div id="footer" role="contentinfo">

<div class="section footer-body">

Document generated by Confluence on Oct 15, 2025 11:43

<div id="footer-logo">

[Atlassian](http://www.atlassian.com/)

</div>

</div>

</div>

</div>
